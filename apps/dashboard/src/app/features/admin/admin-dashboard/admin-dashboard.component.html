<div class="layout">
  <p class="intro">Access logs for task and auth actions (Owner and Admin only).</p>

  @if (loading) {
    <div class="skeletons">
      @for (i of [1,2,3,4,5]; track i) {
        <app-skeleton height="48px" />
      }
    </div>
  } @else if (error) {
    <p class="error">{{ error }}</p>
  } @else {
    <div class="table-wrap">
      <table class="audit-table">
        <thead>
          <tr>
            <th>Time</th>
            <th>Action</th>
            <th>Resource</th>
            <th>Resource ID</th>
            <th>User ID</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody>
          @for (entry of logs; track entry.id) {
            <tr>
              <td>{{ entry.createdAt | date:'short' }}</td>
              <td><span class="badge badge--{{ entry.action }}">{{ entry.action }}</span></td>
              <td>{{ entry.resource }}</td>
              <td>{{ entry.resourceId ?? '&#8212;' }}</td>
              <td class="mono">{{ entry.userId }}</td>
              <td>{{ formatDetails(entry.details) }}</td>
            </tr>
          }
        </tbody>
      </table>
    </div>

    @if (logs.length === 0 && !loading) {
      <p class="empty">No audit log entries yet.</p>
    }
  }

  <a routerLink="/tasks" class="back-link">&#8592; Back to tasks</a>
</div>
